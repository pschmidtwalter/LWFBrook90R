<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Provides a flexible and easy-to use interface for the soil vegetation 
    atmosphere transport (SVAT) model LWF-BROOK90, written in Fortran.
    The model simulates daily transpiration, interception, soil and snow evaporation, 
    streamflow and soil water fluxes through a soil profile covered with vegetation, 
    as described in Hammel &amp; Kennel (2001, ISBN:978-3-933506-16-0) and Federer et al. (2003) 
    &lt;doi:10.1175/1525-7541(2003)004%3C1276:SOAETS%3E2.0.CO;2&gt;. A set of high-level functions
    for model set up, execution and parallelization provides easy access to plot-level SVAT 
    simulations, as well as multi-run and large-scale applications. ">
<title>Simulate Evapotranspiration and Soil Moisture with the SVAT Model LWF-Brook90  â€¢ LWFBrook90R</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simulate Evapotranspiration and Soil Moisture with the SVAT Model LWF-Brook90 ">
<meta property="og:description" content="Provides a flexible and easy-to use interface for the soil vegetation 
    atmosphere transport (SVAT) model LWF-BROOK90, written in Fortran.
    The model simulates daily transpiration, interception, soil and snow evaporation, 
    streamflow and soil water fluxes through a soil profile covered with vegetation, 
    as described in Hammel &amp; Kennel (2001, ISBN:978-3-933506-16-0) and Federer et al. (2003) 
    &lt;doi:10.1175/1525-7541(2003)004%3C1276:SOAETS%3E2.0.CO;2&gt;. A set of high-level functions
    for model set up, execution and parallelization provides easy access to plot-level SVAT 
    simulations, as well as multi-run and large-scale applications. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">LWFBrook90R</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/LWFBook90R-1-Intro.html">Introduction to LWFBrook90R</a>
    <a class="dropdown-item" href="articles/LWFBrook90R-2-Options_Param.html">Model control options and parameters</a>
    <a class="dropdown-item" href="articles/LWFBrook90R-3-Multiruns.html">Multi-run simulations in LWFBrook90R</a>
    <a class="dropdown-item" href="articles/LWFBrook90R-4-Multisite-Runs.html">Multi-Site simulations using `run_multisite_LWFB90()`</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pschmidtwalter/LWFBrook90R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="lwfbrook90r">LWFBrook90R<a class="anchor" aria-label="anchor" href="#lwfbrook90r"></a>
</h1></div>
<!-- badges: start -->
<p><code>LWFBroo90R</code> provides an implementation of the Soil Vegetation Atmosphere Transport (SVAT) model <a href="https://www.lwf.bayern.de/boden-klima/wasserhaushalt/index.php" class="external-link">LWF-BROOK90</a> (Hammel &amp; Kennel, 2001) written in Fortran. The model simulates daily transpiration, interception, soil and snow evaporation, streamflow and soil water fluxes through a soil profile covered with vegetation. A set of high-level functions for model set up, execution and parallelization provide easy access to plot-level SVAT simulations, as well as multi-run and large-scale applications.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of LWFBrook90R from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"LWFBrook90R"</span><span class="op">)</span></code></pre></div>
<p>and the development version can be installed from <a href="https://github.com/pschmidtwalter/LWFBrook90R" class="external-link">Github</a> using the package <code>remotes</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span>repo<span class="op">=</span><span class="st">"pschmidtwalter/LWFBrook90R"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Below is basic example. For more complex examples take a look at the packages vignettes with <code>browseVignettes("LWFBrook90R")</code>.</p>
<p>The main function <code><a href="reference/run_LWFB90.html">run_LWFB90()</a></code> creates the model input from model control options, parameters, climate and soil data and returns the simulation results.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load package and sample data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/pschmidtwalter/LWFBrook90R" class="external-link">LWFBrook90R</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">slb1_meteo</span>, <span class="va">slb1_soil</span><span class="op">)</span>

<span class="co"># set up default model control options and parameters</span>
<span class="va">opts</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/set_optionsLWFB90.html">set_optionsLWFB90</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">parms</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/set_paramLWFB90.html">set_paramLWFB90</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Derive soil hydraulic properties from soil physical properties </span>
<span class="co"># using a pedotransfer function: </span>
<span class="va">soil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">slb1_soil</span>, <span class="fu"><a href="reference/ptfs.html">hydpar_wessolek_tab</a></span><span class="op">(</span>texture <span class="op">=</span> <span class="va">slb1_soil</span><span class="op">$</span><span class="va">texture</span><span class="op">)</span><span class="op">)</span>

<span class="co"># run the model and capture results</span>
<span class="va">lwfb90_res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/run_LWFB90.html">run_LWFB90</a></span><span class="op">(</span>options_b90 <span class="op">=</span> <span class="va">opts</span>,
                         param_b90 <span class="op">=</span> <span class="va">parms</span>,
                         climate <span class="op">=</span> <span class="va">slb1_meteo</span>,
                         soil <span class="op">=</span> <span class="va">soil</span><span class="op">)</span></code></pre></div>
<p>Plot results</p>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<p>Schmidt-Walter, P., Trotsiuk, V., Meusburger, K., Zacios, M., Meesenburg, H. (2020): Advancing simulations of water fluxes, soil moisture and drought stress by using the LWF-Brook90 hydrological model in R. Agr. For. Met. 291, 108023. <a href="https://doi.org/10.1016/j.agrformet.2020.108023" class="external-link uri">https://doi.org/10.1016/j.agrformet.2020.108023</a></p>
</div>
<div class="section level2">
<h2 id="contributions">Contributions<a class="anchor" aria-label="anchor" href="#contributions"></a>
</h2>
<p>Implementations of further methods for creating model input (e.g.Â leaf area dynamics, root depth density distributions, pedotransfer functions) and other improvements are highly welcome.</p>
</div>
<div class="section level2">
<h2 id="authors">Authors<a class="anchor" aria-label="anchor" href="#authors"></a>
</h2>
<p>Paul Schmidt-Walter, Volodymyr Trotsiuk, Klaus Hammel, Martin Kennel, Tony Federer.</p>
<p>Tony Federerâ€™s original <a href="http://www.ecoshift.net/brook/b90doc.html" class="external-link">Brook90</a> Fortran 77 code (Brook90_v3.1F, License: CC0) was enhanced by Klaus Hammel and Martin Kennel at Bavarian State Institute of Forestry (LWF) around the year 2000. Since then, LWF-BROOK90 is distributed by <a href="https://www.lwf.bayern.de/boden-klima/wasserhaushalt/index.php" class="external-link">LWF</a> upon request as a pre-compiled Fortran command line program together with an MS Access User Interface. In 2019, Volodymyr Trotsiuk converted the Fortran 77 code to Fortran 95 and implemented the connection to R. Paul Schmidt-Walterâ€™s <code>brook90r</code> (Schmidt-Walter, 2018) package for LWF-Brook90 input data generation, model execution and result processing was adapted and extended to control this interface function.</p>
</div>
<div class="section level2">
<h2 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a>
</h2>
<p>GPL-3 for all Fortran and R code. <code>brook90r</code> has GPL-3, while LWF-Brook90 was without license until recently. Lothar Zimmermann and Stephan Raspe (LWF), and all previous Fortran contributors agreed to assign GPL-3 to the Fortran code.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Federer C.A. (2002): BROOK 90: A simulation model for evaporation, soil water, and streamflow. <a href="http://www.ecoshift.net/brook/brook90.htm" class="external-link uri">http://www.ecoshift.net/brook/brook90.htm</a></p>
<p>Federer C.A., VÃ¶rÃ¶smarty, C., Fekete, B. (2003): Sensitivity of Annual Evaporation to Soil and Root Properties in Two Models of Contrasting Complexity. J. Hydrometeorol. 4, 1276â€“1290. <a href="https://doi.org/10.1175/1525-7541(2003)004%3C1276:SOAETS%3E2.0.CO;2" class="external-link uri">https://doi.org/10.1175/1525-7541(2003)004%3C1276:SOAETS%3E2.0.CO;2</a></p>
<p>Hammel, K., Kennel, M. (2001): Charakterisierung und Analyse der WasserverfÃ¼gbarkeit und des Wasserhaushalts von Waldstandorten in Bayern mit dem Simulationsmodell BROOK90. Forstliche Forschungsberichte MÃ¼nchen 185. ISBN 978-3-933506-16-0</p>
<p>Schmidt-Walter, P. (2018). brook90r: Run the LWF-BROOK90 hydrological model from within R (Version v1.0.1). Zenodo. <a href="https://doi.org/10.5281/zenodo.1433677" class="external-link uri">https://doi.org/10.5281/zenodo.1433677</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=LWFBrook90R" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/pschmidtwalter/LWFBrook90R/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/pschmidtwalter/LWFBrook90R/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing LWFBrook90R</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Paul Schmidt-Walter <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2699-0893" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Volodymyr Trotsiuk <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-8363-656X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Klaus Hammel <br><small class="roles"> Author </small>  </li>
<li>Martin Kennel <br><small class="roles"> Author </small>  </li>
<li>Anthony Federer <br><small class="roles"> Author </small>  </li>
<li>Bavarian State Institute of Forestry (LWF) <br><small class="roles"> Copyright holder, funder </small>  </li>
<li>Northwest German Forest Research Institute (NW-FVA) <br><small class="roles"> Copyright holder, funder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.repostatus.org/#active" class="external-link"><img src="https://www.repostatus.org/badges/latest/active.svg" alt="Project Status: Active â€“ The project has reached a stable, usable state and is being actively developed."></a></li>
<li><a href="https://github.com/pschmidtwalter/LWFBrook90R/actions" class="external-link"><img src="https://github.com/pschmidtwalter/LWFBrook90R/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://cran.r-project.org/package=LWFBrook90R" class="external-link"><img src="https://www.r-pkg.org/badges/version/LWFBrook90R" alt="CRAN"></a></li>
<li><a href="https://cran.r-project.org/package=LWFBrook90R" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/LWFBrook90R"></a></li>
<li><a href="https://www.gnu.org/licenses/gpl-3.0" class="external-link"><img src="https://img.shields.io/badge/License-GPL%20v3-blue.svg" alt="License: GPL v3"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.3760298" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.3760298.svg" alt="DOI"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Paul Schmidt-Walter, Volodymyr Trotsiuk, Klaus Hammel, Martin Kennel, Anthony Federer, Bavarian State Institute of Forestry (LWF), Northwest German Forest Research Institute (NW-FVA).</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
