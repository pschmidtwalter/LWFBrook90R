<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model control options and parameters • LWFBrook90R</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Model control options and parameters">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LWFBrook90R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/LWFBook90R-1-Intro.html">Introduction to LWFBrook90R</a>
    </li>
    <li>
      <a href="../articles/LWFBrook90R-2-Options_Param.html">Model control options and parameters</a>
    </li>
    <li>
      <a href="../articles/LWFBrook90R-3-Multiruns.html">Multi-run simulations in LWFBrook90R</a>
    </li>
    <li>
      <a href="../articles/LWFBrook90R-4-Multisite-Runs.html">Multi-Site simulations using `run_multisite_LWFB90()`</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pschmidtwalter/LWFBrook90R/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Model control options and parameters</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pschmidtwalter/LWFBrook90R/blob/master/vignettes/LWFBrook90R-2-Options_Param.Rmd" class="external-link"><code>vignettes/LWFBrook90R-2-Options_Param.Rmd</code></a></small>
      <div class="hidden name"><code>LWFBrook90R-2-Options_Param.Rmd</code></div>

    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>This vignette demonstrates the use of different model control option
setting (<code>options_90</code>-argument of <code>runLWFB90()</code>)
and parameters (<code>param_b90</code>-argument).</p>
<p>Aside from the basic technical information of the simulation
(<code>startdate</code>, <code>enddate</code>, <code>fornetrad</code>,
<code>prec_interval</code> and <code>correct_prec</code>), the model
control options control the annual course of leaf area index
(<code>lai_method</code>), the phenology models to use
(<code>budburst_method</code>, <code>leaffall_method</code>), the input
and interpolations of annual stand properties
(<code>standprop_input</code>, <code>standprop_interp</code>,
<code>use_growthperiod</code>) and which root density depth distribution
function to use (<code>root_method</code>). The interplay of options and
parameters is shown briefly in the following paragraphs, by describing
how options and parameters are passed from the <code>options_b90</code>
and <code>param_b90</code> arguments to the individual functions that
are called from within <code><a href="../reference/run_LWFB90.html">run_LWFB90()</a></code>.</p>
<p>For this purpose, we create basic lists of model control options and
parameters, as well as soil and climate objects.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pschmidtwalter.github.io/LWFBrook90R/">LWFBrook90R</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">options_b90</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_optionsLWFB90.html">set_optionsLWFB90</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">param_b90</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/set_paramLWFB90.html">set_paramLWFB90</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="aboveground-vegetation-characteristics">Aboveground vegetation characteristics<a class="anchor" aria-label="anchor" href="#aboveground-vegetation-characteristics"></a>
</h3>
<div class="section level4">
<h4 id="intra-annual-variation-of-leaf-area-index">Intra-annual variation of leaf area index<a class="anchor" aria-label="anchor" href="#intra-annual-variation-of-leaf-area-index"></a>
</h4>
<p>The default parameter set (created with
<code><a href="../reference/set_paramLWFB90.html">set_paramLWFB90()</a></code>) represents a deciduous forest stand,
without leafs in winter and maximum leaf area index in summer. The
maximum leaf area index is defined by the parameter
<code>param_b90$maxlai</code>, the minimum value in winter is internally
calculated as a fraction (<code>param_b90$winlaifrac</code>) of
<code>param_b90$maxlai</code>. The basic shape of the intra-annual leaf
area index dynamics can be selected by the option
<code>options_b90$lai_method</code>. The default setting
<code>'b90'</code> makes use of the parameters <code>budburstdoy</code>,
<code>leaffalldoy</code>, <code>emergedur</code> and
<code>leaffalldur</code>, that define the dates of budburst and
leaffall, and the durations of leaf unfolding and leaf shedding until
<code>maxlai</code>, and respectively <code>winlaifrac</code> in winter
are reached. Within <code><a href="../reference/run_LWFB90.html">run_LWFB90()</a></code>, the parameters are passed
to <code><a href="../reference/make_seasLAI.html">make_seasLAI()</a></code> that constructs the daily timeseries of
leaf area index development for a single year:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LAI_b90</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/make_seasLAI.html">make_seasLAI</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">lai_method</span>,</span>
<span>                         year <span class="op">=</span> <span class="fl">2003</span>,</span>
<span>                         maxlai <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">maxlai</span>,</span>
<span>                         winlaifrac <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">winlaifrac</span>,</span>
<span>                         budburst_doy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">budburstdoy</span>,</span>
<span>                         leaffall_doy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">leaffalldoy</span>,</span>
<span>                         emerge_dur <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">emergedur</span>,</span>
<span>                         leaffall_dur <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">leaffalldur</span><span class="op">)</span></span></code></pre></div>
<p><code><a href="../reference/make_seasLAI.html">make_seasLAI()</a></code> also provides other shape functions that
require additional parameters. For example, the option
<code>lai_method = 'linear'</code> uses value pairs of day-of-year and
leaf area index as fraction of <code>maxlai</code> passed from
parameters <code>param_b90$lai_doy</code> and
<code>param_b90$lai_frac</code>. The doy/value-pairs are then used to
interpolate the intra-annual course of leaf area index to a daily time
series.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">options_b90</span><span class="op">$</span><span class="va">lai_method</span> <span class="op">&lt;-</span> <span class="st">"linear"</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">lai_doy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">110</span>,<span class="fl">117</span>,<span class="fl">135</span>,<span class="fl">175</span>,<span class="fl">220</span>,<span class="fl">250</span>,<span class="fl">290</span>,<span class="fl">365</span><span class="op">)</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">lai_frac</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">1.2</span>,<span class="fl">1.2</span>,<span class="fl">1.0</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">LAI_linear</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/make_seasLAI.html">make_seasLAI</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">lai_method</span>,</span>
<span>                            year <span class="op">=</span> <span class="fl">2003</span>,</span>
<span>                            maxlai <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">maxlai</span>,</span>
<span>                            lai_doy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">lai_doy</span> ,</span>
<span>                            lai_frac <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">lai_frac</span><span class="op">)</span></span></code></pre></div>
<p>A third shape-option for the intra-annual variation of leaf area
index is called ‘Coupmodel’ and uses the interpolation method as
implemented in the ‘Coupmodel’ <span class="citation">(Jansson and
Karlberg 2004)</span>. With <code>lai_method ='Coupmodel</code>, form
parameters for leaf unfolding and leaf fall (<code>shp_budburst</code>,
<code>shp_leaffall</code>), and the date when leaf area is at its
maximum (<code>shp_optdoy</code>) are required, in addition to the
parameters required <code>by lai_method = 'b90'</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">options_b90</span><span class="op">$</span><span class="va">lai_method</span> <span class="op">&lt;-</span> <span class="st">"Coupmodel"</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">shp_budburst</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">shp_leaffall</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">shp_optdoy</span> <span class="op">&lt;-</span> <span class="fl">180</span></span>
<span><span class="va">LAI_coupmodel</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/make_seasLAI.html">make_seasLAI</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">lai_method</span>,</span>
<span>                               year <span class="op">=</span> <span class="fl">2003</span>,</span>
<span>                               maxlai <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">maxlai</span>,</span>
<span>                               budburst_doy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">budburstdoy</span>,</span>
<span>                               leaffall_doy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">leaffalldoy</span>,</span>
<span>                               shp_budburst <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">shp_budburst</span>,</span>
<span>                               shp_leaffall <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">shp_leaffall</span>,</span>
<span>                               shp_optdoy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">shp_optdoy</span><span class="op">)</span></span></code></pre></div>
<p>A plot of all three methods shows the roles of the different
parameters:</p>
<div class="figure">
<img src="LWFBrook90R-2-Options_Param_files/figure-html/unnamed-chunk-5-1.png" alt="Methods featured by make_seasLAI()" width="672"><p class="caption">
Methods featured by make_seasLAI()
</p>
</div>
</div>
<div class="section level4">
<h4 id="inter-annual-variation-of-leaf-area-index">Inter-annual variation of leaf area index<a class="anchor" aria-label="anchor" href="#inter-annual-variation-of-leaf-area-index"></a>
</h4>
<p>By passing a single value via <code>param_b90$maxlai</code> we used
the same maximum leaf area index for each year of the simulation period.
In order to incorporate between-year variation of the leaf area index,
we can simply assign vectors of values for each year of the simulation
period to any of the parameters used by function
<code><a href="../reference/make_seasLAI.html">make_seasLAI()</a></code>. In the following example, we pass three
values for <code>maxlai</code> and <code>shp_optdoy</code>, to get
different seasonal courses of leaf area index for the three years of the
simulation period. Additionally, we add variation to the dates of
budburst, by assigning a vector of values to the parameter
<code>budburstdoy</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">years</span> <span class="op">&lt;-</span> <span class="fl">2001</span><span class="op">:</span><span class="fl">2003</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">maxlai</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">shp_optdoy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">210</span>,<span class="fl">180</span>,<span class="fl">240</span><span class="op">)</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">shp_budburst</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">0.3</span><span class="op">)</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">budburstdoy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">135</span>,<span class="fl">121</span><span class="op">)</span> </span>
<span><span class="va">lai_variation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_seasLAI.html">make_seasLAI</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">lai_method</span>,</span>
<span>                              year <span class="op">=</span> <span class="va">years</span>,</span>
<span>                              maxlai <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">maxlai</span>,</span>
<span>                              budburst_doy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">budburstdoy</span>,</span>
<span>                              leaffall_doy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">leaffalldoy</span>,</span>
<span>                              shp_budburst <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">shp_budburst</span>,</span>
<span>                              shp_leaffall <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">shp_leaffall</span>,</span>
<span>                              shp_optdoy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">shp_optdoy</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="LWFBrook90R-2-Options_Param_files/figure-html/unnamed-chunk-6-1.png" alt="Options and parameters affecting interannual variation of leaf area index." width="672"><p class="caption">
Options and parameters affecting interannual variation of leaf area
index.
</p>
</div>
<p>Beside the obvious between-year variation of maximum leaf area index,
we can also see the effect of the shape parameter for the leaf unfolding
phase <code>shp_budburst</code>. Values greater 1 result in concave,
values below 1 in convex functions, while values of 1 give linear
progressions. The budburst day-of-year is varying as specified in the
parameters, but can also be estimated using temperature based phenology
models. By selecting other settings than the default
<code>options_b90$budburst_method = 'fixed'</code> and
<code>options_b90$leaffall_method = 'fixed'</code>, the
<code>vegperiod()</code> function of the ‘vegperiod’-Package is called
from within <code>run_LWFB90</code>. <code>budburstdoy</code> and/or
<code>leaffalldoy</code> are then calculated for each year from the
climate data using the desired methods. See <code>vegperiod</code> for a
list of available models. The estimated values for
<code>budburstdoy</code> and/or <code>leaffalldoy</code> can be found in
the <code>param_b90</code> list element of the results object after the
simulation.</p>
</div>
<div class="section level4">
<h4 id="other-plant-properties-height-sai-densef">Other plant properties (<code>height</code>, <code>sai</code>,
<code>densef</code>)<a class="anchor" aria-label="anchor" href="#other-plant-properties-height-sai-densef"></a>
</h4>
<p>Like the leaf area index parameters and budburst/leaffall-dates, it
is also possible to provide vectors of values for stand height
(<code>height</code>), stem area index (<code>sai</code>), and stand
density (<code>densef</code>) to generate between-year variation of
stand characteristics. From the yearly values, daily values are
interpolated using the function <code><a href="../reference/approx_standprop.html">approx_standprop()</a></code>. The
<code>approx.method</code>- argument of the function defines how to
interpolate the yearly values passed by <code>y</code>. Within
<code><a href="../reference/run_LWFB90.html">run_LWFB90()</a></code>, the option
<code>options_b90$standprop_interp</code> is passed to the
<code>approx.method</code>- argument of <code>approx_standprop</code>.
The default interpolation method
<code>standprop_interp = 'constant'</code> results in a yearly changing
step function, while <code>standprop_interp = 'linear'</code>
interpolates the values:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># constant 'interpolation'</span></span>
<span><span class="va">options_b90</span><span class="op">$</span><span class="va">standprop_interp</span> <span class="op">&lt;-</span> <span class="st">'constant'</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">height</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20.2</span>,<span class="fl">20.8</span>,<span class="fl">21.3</span><span class="op">)</span></span>
<span><span class="va">simyears</span> <span class="op">&lt;-</span> <span class="fl">2002</span><span class="op">:</span><span class="fl">2003</span></span>
<span><span class="va">height_c</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/approx_standprop.html">approx_standprop</a></span><span class="op">(</span>x_yrs<span class="op">=</span><span class="va">years</span>,</span>
<span>                             y <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">height</span>,</span>
<span>                             approx.method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">standprop_interp</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># linear interpolation       </span></span>
<span><span class="va">options_b90</span><span class="op">$</span><span class="va">standprop_interp</span> <span class="op">&lt;-</span> <span class="st">'linear'</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">height_ini</span> <span class="op">&lt;-</span> <span class="fl">19.1</span></span>
<span><span class="va">height_l</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/approx_standprop.html">approx_standprop</a></span><span class="op">(</span>x_yrs<span class="op">=</span><span class="va">years</span>,</span>
<span>                             y <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">height</span>,</span>
<span>                             y_ini <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">height_ini</span>,</span>
<span>                             approx.method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">standprop_interp</span><span class="op">)</span></span></code></pre></div>
<p>For linear interpolation, additional parameters
<code>height_ini</code>, <code>sai_ini</code>, <code>densef_ini</code>
have to be provided to <code><a href="../reference/run_LWFB90.html">run_LWFB90()</a></code> via the
<code>param_b90</code>-argument. These parameters define the values at
the beginning of the simulation, to which the value of the first year is
interpolated to. By default, the yearly values are interpreted to be
valid at December 31st of the respective years, so that the interpolated
timeseries are linearly increasing or decreasing during the whole year.
In order to constrain the interpolation to the growth period only, the
option <code>options_b90$use_growthperiod</code> was introduced, which
requires the arguments <code>startdoy</code> and <code>enddoy</code>,
when set to <code>TRUE</code>. Then, values decrease or increase between
budburst and leaffall only, and remain constant during winter.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">options_b90</span><span class="op">$</span><span class="va">use_growthperiod</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span><span class="va">height_l_gp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/approx_standprop.html">approx_standprop</a></span><span class="op">(</span>x_yrs <span class="op">=</span> <span class="va">years</span>,</span>
<span>                                y <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">height</span>,</span>
<span>                                y_ini <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">height_ini</span>,</span>
<span>                                use_growthperiod <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">use_growthperiod</span>,</span>
<span>                                startdoy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">budburstdoy</span>,</span>
<span>                                enddoy <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">leaffalldoy</span>,</span>
<span>                                approx.method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">standprop_interp</span><span class="op">)</span></span></code></pre></div>
<p>The following plot explains the differences between the interpolated
timeseries of stand height using the different options and
parameters:</p>
<div class="figure">
<img src="LWFBrook90R-2-Options_Param_files/figure-html/unnamed-chunk-9-1.png" alt="Interpolated stand height derived from parameters using approx_standprop()" width="672"><p class="caption">
Interpolated stand height derived from parameters using
approx_standprop()
</p>
</div>
<p>Another option for incorporating between-year variation of plant
properties is to provide a data.frame with yearly values of
<code>height</code>, <code>maxlai</code>, <code>sai</code>,
<code>densef</code> and <code>age</code> as list item
<code>standprop_table</code> in <code>param_b90</code>. To take effect,
the option <code>options_b90$standprop_input</code> has to be set to
<code>'table'</code>. In this case, the values passed via parameters
<code>height</code>, <code>sai</code>, <code>densef</code> and
<code>age_ini</code> are ignored. As <code>maxlai</code> is also
provided via the table, the <code>maxlai</code> value from parameters is
ignored as well, while the other parameters that affect intra-annual
leaf area development (e.g., <code>shp_budburst</code>) are still
active.</p>
<p>For demonstration purposes we use the table
<code>slb1_standprop</code>, that contains observed stand data of the
Solling Beech Experimental site from 1966 to 2014, along with estimated
leaf and stem area index derived using allometric functions. For
creating the daily timeseries of stand properties, we use
<code><a href="../reference/run_LWFB90.html">run_LWFB90()</a></code>, and make use of the option to not run the
model (<code>run = FALSE</code>), but only return the model input.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Extend simulation period</span></span>
<span><span class="va">options_b90</span><span class="op">$</span><span class="va">startdate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1980-01-01"</span><span class="op">)</span></span>
<span><span class="va">options_b90</span><span class="op">$</span><span class="va">enddate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"1999-12-31"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">soil</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">slb1_soil</span>, <span class="fu"><a href="../reference/ptfs.html">hydpar_wessolek_tab</a></span><span class="op">(</span>texture <span class="op">=</span> <span class="va">slb1_soil</span><span class="op">$</span><span class="va">texture</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#set up options for table input </span></span>
<span><span class="va">options_b90</span><span class="op">$</span><span class="va">standprop_input</span> <span class="op">&lt;-</span> <span class="st">'table'</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">standprop_table</span> <span class="op">&lt;-</span> <span class="va">slb1_standprop</span></span>
<span></span>
<span><span class="co"># Set up dynamic budburst and leaf fall</span></span>
<span><span class="va">options_b90</span><span class="op">$</span><span class="va">budburst_method</span> <span class="op">&lt;-</span> <span class="st">"Menzel"</span></span>
<span><span class="va">options_b90</span><span class="op">$</span><span class="va">leaffall_method</span> <span class="op">&lt;-</span> <span class="st">"vonWilpert"</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">budburst_species</span> <span class="op">&lt;-</span> <span class="st">"Fagus sylvatica"</span></span>
<span></span>
<span><span class="co">#run LWF-Brook90 without simulation</span></span>
<span><span class="va">standprop_daily</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_LWFB90.html">run_LWFB90</a></span><span class="op">(</span>options_b90 <span class="op">=</span> <span class="va">options_b90</span>,</span>
<span>                              param_b90 <span class="op">=</span> <span class="va">param_b90</span>,</span>
<span>                              climate <span class="op">=</span> <span class="va">slb1_meteo</span>,</span>
<span>                              soil <span class="op">=</span> <span class="va">soil</span>,</span>
<span>                              output <span class="op">=</span> <span class="va">output</span>, </span>
<span>                              run <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">standprop_daily</span></span></code></pre></div>
<div class="figure">
<img src="LWFBrook90R-2-Options_Param_files/figure-html/unnamed-chunk-11-1.png" alt="Stand properties generated using table input of annual stand characteristics" width="672"><p class="caption">
Stand properties generated using table input of annual stand
characteristics
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="root-density-depth-distribution">Root density depth distribution<a class="anchor" aria-label="anchor" href="#root-density-depth-distribution"></a>
</h3>
<p>The root depth density depth distribution can either be provided in
the column <code>rootden</code> of the <code>soil</code>- argument of
<code><a href="../reference/run_LWFB90.html">run_LWFB90()</a></code>, or can be derived from parameters using the
function <code><a href="../reference/make_rootden.html">make_rootden()</a></code>. In order to use root density as
specified in the soil data, the <code>root_method</code> element of the
<code>options_b90</code>-list has to be set to <code>'soilvar'</code>.
Other method names are passed to <code><a href="../reference/make_rootden.html">make_rootden()</a></code>. Currently,
the function provides four methods to assign values of relative root
density to a vector of soil depths. The default method
<code>'betamodel'</code> uses the model of Gale &amp; Grigal (-<span class="citation">Gale and Grigal (1987)</span>), which is of the form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>β</mi><mi>d</mi></msup></mrow><annotation encoding="application/x-tex">y = 1-
\beta^d</annotation></semantics></math>, where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>y</mi><annotation encoding="application/x-tex">y</annotation></semantics></math>
is the cumulative root fraction down to soil depth
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>d</mi><annotation encoding="application/x-tex">d</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
is the depth coefficient. Larger values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
correspond to a greater proportion of roots in deeper soil layers:</p>
<p><img src="LWFBrook90R-2-Options_Param_files/figure-html/unnamed-chunk-12-1.png" width="384"></p>
<p>For larger values of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>,
the root density will reach zero only in very deep soil layers. In order
to set the root density to zero at any desired soil depth, the parameter
<code>maxrootdepth</code> was defined. With this parameter, the root
density is set to zero in all soil layers that lie deeper than
<code>maxrootdepth</code>. Within <code><a href="../reference/run_LWFB90.html">run_LWFB90()</a></code>, the
function is called in the following way:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">param_b90</span><span class="op">$</span><span class="va">maxrootdepth</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1.4</span></span>
<span><span class="va">options_b90</span><span class="op">$</span><span class="va">root_method</span> <span class="op">&lt;-</span> <span class="st">"betamodel"</span> </span>
<span><span class="va">roots_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_rootden.html">make_rootden</a></span><span class="op">(</span>soilnodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">slb1_soil</span><span class="op">$</span><span class="va">upper</span><span class="op">)</span>, <span class="va">slb1_soil</span><span class="op">$</span><span class="va">lower</span><span class="op">)</span>, </span>
<span>                           maxrootdepth <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">maxrootdepth</span>,</span>
<span>                           beta <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">betaroot</span>,</span>
<span>                           method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">root_method</span><span class="op">)</span></span></code></pre></div>
<p>A second option to define the root distribution for the soil layers
is to provide value pairs of soil depth and root density in a data.frame
and assign it to the <code>rootden_table</code>-entry in
<code>param_b90</code>. As an example, we set up a hypothetical root
density depth distribution:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">options_b90</span><span class="op">$</span><span class="va">root_method</span> <span class="op">&lt;-</span> <span class="st">'table'</span></span>
<span><span class="va">param_b90</span><span class="op">$</span><span class="va">rootden_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  upper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.03</span>,<span class="fl">0</span>,<span class="op">-</span><span class="fl">0.02</span>, <span class="op">-</span><span class="fl">0.15</span>, <span class="op">-</span><span class="fl">0.35</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.65</span>,<span class="op">-</span><span class="fl">0.9</span>,<span class="op">-</span><span class="fl">1.1</span>,<span class="op">-</span><span class="fl">1.3</span><span class="op">)</span>,</span>
<span>  lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="op">-</span><span class="fl">0.02</span>, <span class="op">-</span><span class="fl">0.15</span>, <span class="op">-</span><span class="fl">0.35</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="op">-</span><span class="fl">0.65</span>,<span class="op">-</span><span class="fl">0.9</span>,<span class="op">-</span><span class="fl">1.1</span>,<span class="op">-</span><span class="fl">1.3</span>,<span class="op">-</span><span class="fl">1.6</span><span class="op">)</span>,</span>
<span>  rootden <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">15</span>, <span class="fl">35</span>, <span class="fl">15</span>, <span class="fl">7.5</span>, <span class="fl">4</span>, <span class="fl">12</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">roots_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_rootden.html">make_rootden</a></span><span class="op">(</span>soilnodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">slb1_soil</span><span class="op">$</span><span class="va">upper</span><span class="op">)</span>, <span class="va">slb1_soil</span><span class="op">$</span><span class="va">lower</span><span class="op">)</span>, </span>
<span>                            method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">root_method</span>, </span>
<span>                            rootdat <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">rootden_table</span><span class="op">)</span></span></code></pre></div>
<p>A third option generates a linear root density depth distribution,
with the maximum at the uppermost soil layer and a root density of 0 at
<code>maxrootdepth</code>. If the parameter <code>relrootden</code> is
provided, the first element of the vector is used as the maximum,
otherwise the interpolation is made between 0 and 1. The last option
returns a uniform root distribution, with the first vector-element of
<code>relrootden</code> (if provided) as value for all layers down to
<code>maxrootdepth</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">options_b90</span><span class="op">$</span><span class="va">root_method</span> <span class="op">&lt;-</span> <span class="st">'linear'</span></span>
<span><span class="va">roots_linear</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_rootden.html">make_rootden</a></span><span class="op">(</span>soilnodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">slb1_soil</span><span class="op">$</span><span class="va">upper</span><span class="op">)</span>, <span class="va">slb1_soil</span><span class="op">$</span><span class="va">lower</span><span class="op">)</span>, </span>
<span>                             maxrootdepth <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">maxrootdepth</span>,</span>
<span>                             method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">root_method</span><span class="op">)</span></span>
<span><span class="va">options_b90</span><span class="op">$</span><span class="va">root_method</span> <span class="op">&lt;-</span> <span class="st">'const'</span></span>
<span><span class="va">roots_constant</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_rootden.html">make_rootden</a></span><span class="op">(</span>soilnodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">slb1_soil</span><span class="op">$</span><span class="va">upper</span><span class="op">)</span>, <span class="va">slb1_soil</span><span class="op">$</span><span class="va">lower</span><span class="op">)</span>, </span>
<span>                               maxrootdepth <span class="op">=</span> <span class="va">param_b90</span><span class="op">$</span><span class="va">maxrootdepth</span>,</span>
<span>                               method <span class="op">=</span> <span class="va">options_b90</span><span class="op">$</span><span class="va">root_method</span><span class="op">)</span></span></code></pre></div>
<p><img src="LWFBrook90R-2-Options_Param_files/figure-html/unnamed-chunk-15-1.png" width="384"></p>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-gale_vertical_1987" class="csl-entry">
Gale, M. R., and D. F. Grigal. 1987. <span>“Vertical Root Distributions
of Northern Tree Species in Relation to Successional Status.”</span>
<em>Canadian Journal of Forest Research</em> 17 (8): 829–34.
</div>
<div id="ref-jansson_coupled_2004" class="csl-entry">
Jansson, P.-E., and L. Karlberg. 2004. <span>“Coupled Heat and Mass
Transfer Model for Soil-Plant-Atmosphere Systems.”</span> Stockholm:
Royal Institute of Technolgy, Dept of Civil; Environmental Engineering
Stockholm.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Paul Schmidt-Walter, Volodymyr Trotsiuk, Klaus Hammel, Martin Kennel, Anthony Federer, Tobias Hohenbrink, Gisbert Hetkamp, Bavarian State Institute of Forestry (LWF), Northwest German Forest Research Institute (NW-FVA).</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
